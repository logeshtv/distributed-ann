<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ML Training Dashboard</title>
    <link rel="stylesheet" href="/static/styles.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
</head>

<body>
    <div class="app">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <span class="logo-icon">üéØ</span>
                    <h1>ML Training Dashboard</h1>
                </div>
                <div class="header-status">
                    <span class="status-indicator" id="connectionStatus">
                        <span class="status-dot"></span>
                        <span class="status-text">Connecting...</span>
                    </span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <div class="dashboard-grid">
                <!-- Data Download Card -->
                <section class="card data-card">
                    <div class="card-header">
                        <h2>üì• Download Training Data</h2>
                        <span class="download-status" id="downloadStatus">Ready</span>
                    </div>
                    <div class="card-body">
                        <p class="data-description">Download historical market data (2000 - present) for training.
                            Required before first training run.</p>

                        <form id="downloadForm" class="config-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="dataSource">Data Source</label>
                                    <select id="dataSource" name="source">
                                        <option value="all">All (Stocks + Crypto)</option>
                                        <option value="stocks">US Stocks Only</option>
                                        <option value="crypto">Crypto Only</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="universe">Universe Size</label>
                                    <select id="universe" name="universe">
                                        <option value="small">Small (7 stocks, 3 crypto)</option>
                                        <option value="medium" selected>Medium (50 stocks, 10 crypto)</option>
                                        <option value="large">Large (300+ stocks, 50+ crypto)</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="startDate">Start Date</label>
                                    <input type="date" id="startDate" name="start_date" value="2000-01-01">
                                </div>

                                <div class="form-group">
                                    <label for="endDate">End Date</label>
                                    <input type="date" id="endDate" name="end_date" value="">
                                </div>
                            </div>

                            <div class="download-progress" id="downloadProgress" style="display: none;">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="downloadProgressFill"></div>
                                </div>
                                <span class="progress-text" id="downloadProgressText">Downloading...</span>
                            </div>

                            <div class="button-group">
                                <button type="submit" id="downloadBtn" class="btn btn-primary">
                                    <span class="btn-icon">üì•</span>
                                    Download Data
                                </button>
                                <button type="button" id="checkDataBtn" class="btn btn-secondary">
                                    <span class="btn-icon">üîç</span>
                                    Check Existing Data
                                </button>
                            </div>
                        </form>

                        <div class="data-info" id="dataInfo">
                            <p class="data-placeholder">Click "Check Existing Data" to see available datasets</p>
                        </div>
                    </div>
                </section>

                <!-- Training Configuration Card -->
                <section class="card config-card">
                    <div class="card-header">
                        <h2>üìä Training Configuration</h2>
                    </div>
                    <div class="card-body">
                        <form id="trainingForm" class="config-form">
                            <div class="form-group">
                                <label for="epochs">Epochs</label>
                                <input type="number" id="epochs" name="epochs" value="100" min="1" max="1000">
                                <span class="hint">Number of training iterations</span>
                            </div>

                            <div class="form-group">
                                <label for="batchSize">Batch Size</label>
                                <input type="number" id="batchSize" name="batch_size" value="512" min="32" max="2048"
                                    step="32">
                                <span class="hint">Samples per batch (512 recommended)</span>
                            </div>

                            <div class="form-group">
                                <label for="learningRate">Learning Rate</label>
                                <input type="number" id="learningRate" name="learning_rate" value="0.0005" step="0.0001"
                                    min="0.00001" max="0.1">
                                <span class="hint">Step size for optimization</span>
                            </div>

                            <div class="form-group">
                                <label for="patience">Early Stopping Patience</label>
                                <input type="number" id="patience" name="patience" value="15" min="1" max="50">
                                <span class="hint">Epochs to wait before stopping</span>
                            </div>

                            <div class="form-group">
                                <label for="sequenceLength">Sequence Length</label>
                                <input type="number" id="sequenceLength" name="sequence_length" value="60" min="10"
                                    max="200">
                                <span class="hint">Input sequence length (bars)</span>
                            </div>

                            <div class="form-group">
                                <label for="dataPath">Data Path</label>
                                <input type="text" id="dataPath" name="data_path" value="data_storage/raw">
                                <span class="hint">Path to training data</span>
                            </div>

                            <div class="button-group">
                                <button type="submit" id="startBtn" class="btn btn-primary">
                                    <span class="btn-icon">‚ñ∂</span>
                                    Start Training
                                </button>
                                <button type="button" id="stopBtn" class="btn btn-danger" disabled>
                                    <span class="btn-icon">‚èπ</span>
                                    Stop Training
                                </button>
                            </div>
                        </form>
                    </div>
                </section>

                <!-- Live Metrics Card -->
                <section class="card metrics-card">
                    <div class="card-header">
                        <h2>üìà Live Metrics</h2>
                        <span class="training-status" id="trainingStatus">Idle</span>
                    </div>
                    <div class="card-body">
                        <!-- Progress Section -->
                        <div class="progress-section">
                            <div class="epoch-info">
                                <span class="epoch-current" id="currentEpoch">0</span>
                                <span class="epoch-separator">/</span>
                                <span class="epoch-total" id="totalEpochs">0</span>
                                <span class="epoch-label">Epochs</span>
                            </div>

                            <div class="progress-bar-container">
                                <div class="progress-bar" id="progressBar">
                                    <div class="progress-fill"></div>
                                </div>
                                <span class="progress-percent" id="progressPercent">0%</span>
                            </div>

                            <div class="batch-info" id="batchInfo">
                                Batch: <span id="currentBatch">0</span>/<span id="totalBatches">0</span>
                            </div>
                        </div>

                        <!-- Metrics Grid -->
                        <div class="metrics-grid">
                            <div class="metric-item">
                                <span class="metric-label">Train Loss</span>
                                <span class="metric-value" id="trainLoss">-</span>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Val Loss</span>
                                <span class="metric-value" id="valLoss">-</span>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Accuracy</span>
                                <span class="metric-value" id="accuracy">-</span>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Best Val Loss</span>
                                <span class="metric-value highlight" id="bestValLoss">-</span>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Epoch Time</span>
                                <span class="metric-value" id="epochTime">-</span>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">ETA</span>
                                <span class="metric-value" id="eta">-</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Training Log Card -->
                <section class="card log-card">
                    <div class="card-header">
                        <h2>üìÉ Training Log</h2>
                        <button class="btn btn-small" id="clearLogBtn">Clear</button>
                    </div>
                    <div class="card-body">
                        <div class="log-container" id="logContainer">
                            <div class="log-content" id="logContent">
                                <p class="log-placeholder">Training logs will appear here...</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Models Card -->
                <section class="card models-card">
                    <div class="card-header">
                        <h2>üì¶ Trained Models</h2>
                        <button class="btn btn-small" id="refreshModelsBtn">‚Üª Refresh</button>
                    </div>
                    <div class="card-body">
                        <div class="models-list" id="modelsList">
                            <p class="models-placeholder">Loading models...</p>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>ML Training Dashboard v1.0 | Built with FastAPI + WebSocket</p>
        </footer>
    </div>

    <script src="/static/app.js"></script>
</body>

</html>